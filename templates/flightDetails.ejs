<!DOCTYPE html>
<html lang="en">

<head>
    <title>Flight Details</title>
    <link rel="stylesheet" href="/styles.css">
</head>

<body>
    <header>
        <h1>Flight Details</h1>
    </header>

    <main>
        <% if (typeof saved !== 'undefined' && saved) { %>
		<div>Flight saved to your watchlist!</div>
        <% } %>

        <% if (flight) { %>
		<p><strong>Airline:</strong> <%= flight.airline ? flight.airline.name : 'Unknown' %></p>
		<p><%= flight.airline ? (flight.airline.iata + ' / ' + flight.airline.icao) : '' %></p>
		<p><strong>Flight:</strong> <%= flight.flight ? (flight.flight.iata || flight.flight.icao || flight.flight.number) : 'Unknown' %></p>
		<p><strong>Status:</strong> <%= flight.flight_status || 'Unknown' %></p>

		<p><strong>Departure:</strong> <%= flight.departure ? flight.departure.airport : 'Unknown' %></p>
		<p><strong>IATA / ICAO:</strong> <%= flight.departure ? (flight.departure.iata || 'N/A') + ' / ' + (flight.departure.icao || 'N/A') : 'N/A' %></p>
		<p><strong>Scheduled:</strong> <%= flight.departure ? flight.departure.scheduled : 'N/A' %></p>
		<p><strong>Delay:</strong> <%= flight.departure && flight.departure.delay ? flight.departure.delay + ' min' : '—' %></p>

		<p><strong>Arrival:</strong> <%= flight.arrival ? flight.arrival.airport : 'Unknown' %></p>
		<p><strong>IATA / ICAO:</strong> <%= flight.arrival ? (flight.arrival.iata || 'N/A') + ' / ' + (flight.arrival.icao || 'N/A') : 'N/A' %></p>
		<p><strong>Scheduled:</strong> <%= flight.arrival ? flight.arrival.scheduled : 'N/A' %></p>
		<p><strong>Gate / Baggage:</strong> <%= flight.arrival ? ((flight.arrival.gate || '—') + ' / ' + (flight.arrival.baggage || '—')) : '—' %></p>

		<p><strong>Aircraft:</strong> <%= flight.aircraft ? (flight.aircraft.icao24 || '—') : '—' %></p>

		<h3>Save to Watchlist</h3>
		<form action="/saved/quick-add" method="POST">
			<input type="hidden" name="callsign" value="<%= flight.flight ? (flight.flight.icao || flight.flight.iata || '') : '' %>">
			<input type="hidden" name="flightIata" value="<%= flight.flight ? (flight.flight.iata || '') : '' %>">
			<input type="hidden" name="airline" value="<%= flight.airline ? flight.airline.name : '' %>">
			<input type="hidden" name="departureAirport" value="<%= flight.departure ? flight.departure.airport : '' %>">
			<input type="hidden" name="departureIata" value="<%= flight.departure ? flight.departure.iata : '' %>">
			<input type="hidden" name="arrivalAirport" value="<%= flight.arrival ? flight.arrival.airport : '' %>">
			<input type="hidden" name="arrivalIata" value="<%= flight.arrival ? flight.arrival.iata : '' %>">
			<input type="hidden" name="status" value="<%= flight.flight_status || '' %>">

			<label for="priority">Priority</label>
			<select name="priority" id="priority">
				<option value="low">Low</option>
				<option value="medium">Medium</option>
				<option value="high">High</option>
			</select>

			<label for="notes">Notes (optional)</label>
			<input type="text" name="notes" id="notes" placeholder="e.g., Family arriving, Business trip...">
			<button type="submit">Save Flight</button>
		</form>

		<h3>Raw JSON</h3>
		<pre> <%= JSON.stringify(flight, null, 2) %> </pre>
        <% } else { %>
		<p>No flight data found for this callsign.</p>
        <% } %>
    </main>

    <footer>
        <a href="/">Home</a> | <a href="/saved">View Saved Flights</a>
    </footer>
</body>

</html>